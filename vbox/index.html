<!DOCTYPE html>
<html lang="ru">
<head>
<!-- title -->
<title>vbox</title>
<!-- title -->
<!-- meta -->
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<!-- meta -->
<!-- style -->
<link rel="stylesheet" type="text/css" href="../assets/style/all.css" />
<style>
.help {
	width: 160px;
}
.in {
	width: 320px;
}
.out {
	width: 640px;
}
</style>
<!-- style -->
</head>
<body>

<div id="wrapper">
<div id="content">
<h2>vbox (генератор команд управления через терминал)</h2>
<hr />
<input type="text" class="in" oninput="vname();" placeholder="[name или uuid]" autofocus> <a href="javascript:x_clear('in');" title="очистить">очистить</a><br />
<input type="text" class="help" value="VBoxManage list vms" readonly> Список виртуальных машин по имени и uuid<br />
<hr />
pause<br />
<input type="text" class="out" placeholder="VBoxManage controlvm [name или uuid] pause" readonly><br />
unpause<br />
<input type="text" class="out" placeholder="VBoxManage controlvm [name или uuid] resume" readonly><br />
poweroff<br />
<input type="text" class="out" placeholder="VBoxManage controlvm [name или uuid] poweroff" readonly><br />
poweroff savestate<br />
<input type="text" class="out" placeholder="VBoxManage controlvm [name или uuid] savestate" readonly><br />
poweroff button<br />
<input type="text" class="out" placeholder="VBoxManage controlvm [name или uuid] acpipowerbutton" readonly><br />
restart button<br />
<input type="text" class="out" placeholder="VBoxManage controlvm [name или uuid] reset" readonly><br />
startvm gui<br />
<input type="text" class="out" placeholder="VBoxManage startvm [name или uuid] --type gui" readonly><br />
startvm nogui<br />
<input type="text" class="out" placeholder="VBoxManage startvm [name или uuid] --type headless" readonly>
</div>
</div>

<script>
function vname() {
	let fname = ['pause','unpause','poweroff','poweroff_save','poweroff_button','restart_button','vm_gui','vm_nogui'];
	let out = document.querySelectorAll('.out');
	let uuid = document.getElementsByClassName('in')[0];
	let copy = document.querySelectorAll('.copy');
	let i = 0, cache, url, prefix = '';
	uuid.value = uuid.value.trim();
	if (/^\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}$/.test(uuid.value) == false) prefix = uuid.value + '_';
	while (i < out.length) {
		if (copy[i] != undefined) copy[i].remove();
		if (uuid.value.length == 0) {
			out[i].value = '';
		} else {
			cache = out[i].placeholder.replaceAll('[name или uuid]', uuid.value);
			out[i].value = cache;
			url = 'data:application/x-shellscript;charset=utf-8,' + encodeURIComponent('#!/bin/bash\n' + cache);
			out[i].insertAdjacentHTML('afterend', ' <span class=\"copy\"><a href=\"javascript:x_copy(\'out\', ' + i + ');\" title=\"Копировать текст в буфер обмена\">[копировать]</a>, <a href=\"' + url + '\" target=\"_blank\" download=\"' + prefix + fname[i] + '.sh\" title=\"Сохранить в фаил\">[sh скрипт]</a><span>');
		}
		i++;
	}
}

function x_clear(dd) {
	let id = document.getElementsByClassName(dd)[0];
	if (id.value.length == 0) return;
	id.value = '';
	vname();
}

function x_copy(dd, num) {
	let id = document.getElementsByClassName(dd)[num];
	id.select();
	document.execCommand('copy');
}

vname();
</script>

<footer id="footer"><div class="we">
<a href="https://xdiloc.github.io/" title="главная страница">xdiloc.github.io</a>
<span> &starf; </span>
<a href="https://github.com/xdiloc/xdiloc.github.io" target="_blank" title="разработка">github.com</a>
</div></footer>

</body>
</html>
